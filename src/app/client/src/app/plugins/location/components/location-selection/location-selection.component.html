<!-- New Pop up -->
<app-modal-wrapper *ngIf="showModal && !isStepper"
  [config]="{disableClose: true, width: '45rem', id: locationSelectionModalId, panelClass: ['location-selection-modal', 'material-modal']}"
  (dismiss)="closeModal()">
  <ng-template sbModalContent let-data>

    <div mat-dialog-title class="flex-jc-center flex-dc mb-0">
      <ng-content select="[slot=popup-header]"></ng-content>
      <button mat-mini-fab color="warn" class="ml-auto" aria-label="close dialog" mat-dialog-close
        *ngIf="isClosable"><mat-icon>close</mat-icon></button>
    </div>

    <mat-dialog-content class="pt-0">
      <p class="mat-subheading-2 mb-0 text-left" tabindex="0"><ng-content select="[slot=popup-sub-header]" class="mt-8"></ng-content></p>
      <div class="w-100" [appTelemetryImpression]="telemetryImpression">
        <sb-form
          *ngIf="sbFormLocationSelectionDelegate.locationFormConfig && sbFormLocationSelectionDelegate.locationFormConfig.length"
          [config]="sbFormLocationSelectionDelegate.locationFormConfig"
          (initialize)="sbFormLocationSelectionDelegate.onFormInitialize($event)"
          (valueChanges)="sbFormLocationSelectionDelegate.onFormValueChange($event)"
          (dataLoadStatus)="sbFormLocationSelectionDelegate.onDataLoadStatusChange($event)">
        </sb-form>
      </div>
    </mat-dialog-content>

    <mat-dialog-actions align="end">
      <ng-content select="[slot=popup-footer]" class="text-left mb-8" tabindex="0"></ng-content>
      <button mat-raised-button type="button" class="button-rounded text-uppercase" type="button"
        [class.sb-btn-disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading"
        [disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading" (click)="clearUserLocationSelections()"
        tabindex="0">{{resourceService?.frmelmnts?.btn?.clear}}
      </button>
      <button mat-raised-button color="accent" type="button" class="button-rounded text-uppercase ml-8" type="submit"
        [class.sb-btn-disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading || sbFormLocationSelectionDelegate.formGroup?.invalid"
        [disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading || sbFormLocationSelectionDelegate.formGroup?.invalid"
        (click)="updateUserLocation()" tabindex="0">{{resourceService?.frmelmnts?.btn?.submit}}
        <mat-icon>arrow_right_alt</mat-icon>
      </button>
    </mat-dialog-actions>

  </ng-template>
</app-modal-wrapper>

<div *ngIf="!showModal || isStepper">

  <mat-dialog-content [appTelemetryImpression]="telemetryImpression">
    <sb-form
      *ngIf="sbFormLocationSelectionDelegate && sbFormLocationSelectionDelegate.locationFormConfig && sbFormLocationSelectionDelegate.locationFormConfig.length"
      [config]="sbFormLocationSelectionDelegate?.locationFormConfig"
      (initialize)="sbFormLocationSelectionDelegate?.onFormInitialize($event)"
      (valueChanges)="sbFormLocationSelectionDelegate?.onFormValueChange($event); onSbFormValueChange($event);"
      (dataLoadStatus)="sbFormLocationSelectionDelegate?.onDataLoadStatusChange($event, showModal,isStepper)">
    </sb-form>
  </mat-dialog-content>
  <mat-dialog-actions align="end" class="d-flex flex-ai-center flex-jc-center">
    <ng-content select="[slot=popup-footer]" class="text-left mb-8" tabindex="0"></ng-content>
      <button mat-raised-button class="button-rounded text-uppercase" type="button"
      [class.sb-btn-disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading"
      [disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading" (click)="clearUserLocationSelections()"
      tabindex="0">{{resourceService?.frmelmnts?.btn?.clear}}
    </button>
    <button type="submit" mat-raised-button color="accent" class="button-rounded text-uppercase"
      [class.sb-btn-disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading || sbFormLocationSelectionDelegate.formGroup?.invalid"
      [disabled]="sbFormLocationSelectionDelegate.isLocationFormLoading || sbFormLocationSelectionDelegate.formGroup?.invalid"
      (click)="updateUserLocation()" tabindex="0">{{resourceService?.frmelmnts?.btn?.submit}} <mat-icon>arrow_right_alt</mat-icon>
    </button>
  </mat-dialog-actions>

</div>