<!-- Admin role page -->
<div class="relative9 mat-inside-page-container mat-app-background2 user-role-assign-component">
  <div class="d-flex flex-ai-center">
    <button mat-mini-fab color="accent" (click)="goBack()" *ngIf="showingResults" tabindex="0">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h4 class="text-capitalize" *ngIf="!showingResults">{{resourceService?.frmelmnts?.scttl?.userrole1}}</h4>
    <div class="mat-title my-16 ml-16 d-flex" *ngIf="showingResults">Showing results for <b>"{{userObj.userName}}"</b></div>
  </div>
  <div *ngIf="!showingResults">
    <mat-form-field class="w-50 sb-mat-form-search sb-mat-form-field-custom border-radius" appearance="fill">
      <mat-label>Search user by DIKSHA ID</mat-label>
      <mat-icon matPrefix (click)="onEnter(key)">search</mat-icon>
      <input matInput type="text" id="search-within-group" title="Search user by DIKSHA ID"
          placeholder="Search user by DIKSHA ID" [(ngModel)]="key" (keyup.enter)="onEnter(key)">
    </mat-form-field>
    <div class="d-flex flex-dc flex-jc-center no-results-container p-24 my-16 br-24 mat-app-background text-center">
      <div>
        <img height="125px" width="150px" src="./assets/images/erroricon.png">
      </div>
    <div class="my-16 mat-title">No User found</div>
    </div>
  </div>
  
  <div class="add-adminrole" *ngIf="showingResults">
    <div class="add-adminrole__content">
      <div class="user-details mb-16">
        <div class="user-img ml-16">
            <sb-avatar class="my-avatar" [config]=avatarConfig initialsSize="1" [initial]="userObj?.firstName[0]"
                  [attr.title]="userObj?.firstName">
                </sb-avatar>
        </div>
        <div class="user-metadata ml-32">
          <div class="user-name text-left">{{userObj.firstName}} {{userObj.lastName}}</div>
          <div class="user-info">
            <div class="user-id">{{resourceService?.frmelmnts?.lbl?.instacnceId | interpolate:'{instance}': instance }} : {{userObj.userName}}</div>
          </div>
        </div>
      </div>
      <div class="btn-container ml-24 d-flex">
        <button class="sb-btn sb-btn-primary sb-btn-normal sb-left-icon-btn" (click)="enableAssignRole()">+ ADD NEW ROLE</button>
      </div>
      <div class="user-workexp-container" *ngIf="!showCards"></div>
      <div class="user-workexp-container" *ngIf="showCards">
          <div class="user-workexp-card" *ngFor="let item of userRole">
            <div class="user-workexp">
              <div class="user-workexp__header">
                <div class="user-workexp__name mr-auto">{{item.roleName}}</div>
                <div class="user-workexp__btn"><button
                    class="sb-btn sb-btn-xs sb-btn-link-primary sb-left-icon-btn cursor-pointer" (click)="editRole(item)">
                    <i class="icon-svg icon-svg--xxs icon-back mr-4"><svg class="icon icon-svg--primary">
                        <use xlink:href="assets/images/sprite.svg#edit"></use>
                      </svg></i><span>{{resourceService?.frmelmnts?.lbl?.edit}}</span> </button></div>
                      <div class="user-workexp__btn"><button
                        class="sb-btn sb-btn-xs sb-btn-link-primary sb-left-icon-btn cursor-pointer" (click)="deleteRole(item)">
                        <i class="icon-svg icon-svg--xxs icon-back mr-4"><svg class="icon icon-svg--primary">
                            <use xlink:href="assets/images/sprite.svg#delete"></use>
                          </svg></i><span>{{resourceService?.frmelmnts?.btn?.delete}}</span> </button></div>
              </div>
              <div class="user-workexp__metadata">
                <div class="worked-from">{{item.orgName}}</div>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div> 
</div>
  <!-- Admin role page end -->


<app-modal-wrapper *ngIf="showAssignRole" [config]="{disableClose: false, width: '45rem', panelClass: 'material-modal'}" (dismiss)="dismissRoleAssign()">
  <ng-template sbModalContent>
    <div mat-dialog-title>
      <div class="title" tabindex="0" *ngIf="!isEditRole">Add new role</div>
      <div class="title" tabindex="0" *ngIf="isEditRole">Edit role</div>
      <span class="example-spacer"></span>
      <button mat-mini-fab color="warn" class="ml-auto" aria-label="close dialog"
        mat-dialog-close><mat-icon>close</mat-icon></button>
    </div>
    <mat-dialog-content>
      <div class="o-y-visible">
        <form [formGroup]="userDetailsForm">
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>{{resourceService.frmelmnts?.lbl?.role}}</mat-label>
            <mat-select [isSearchable]="false" [(ngModel)]="role"
            (selectedOptionsChange)="enableButton()" formControlName="role" [options]="allRoles"
            labelField="roleName" valueField="role" name="role"
            placeholder="{{resourceService?.frmelmnts?.btn?.selrole}}" #allroles multiple>
              <mat-option *ngFor="let role of allroles.filteredOptions"
              [ngClass]="{disabled: userAssignedRole.includes(role.role)}" [value]="role"></mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>{{resourceService.frmelmnts?.lbl?.orgname}}</mat-label>
            <mat-select [isSearchable]="false" [(ngModel)]="orgName"
            (selectedOptionsChange)="enableButton()" formControlName="orgName" [options]="orgList"
            labelField="orgName" valueField="orgId" name="orgName"
            placeholder="{{resourceService?.frmelmnts?.lbl?.dashboardselectorg}}" #allorgName multiple>
              <mat-option *ngFor="let org of allorgName.filteredOptions" [value]="org"></mat-option>
            </mat-select>
          </mat-form-field>
          <!-- <div class="field">
            <label>{{resourceService.frmelmnts?.lbl?.role}}</label>
          </div>
          <div class="field">
            <sui-multi-select [isSearchable]="false" class="selection" [(ngModel)]="role"
              (selectedOptionsChange)="enableButton()" formControlName="role" [options]="allRoles"
              labelField="roleName" valueField="role" name="role"
              placeholder="{{resourceService?.frmelmnts?.btn?.selrole}}" #allroles>
              <sui-select-option *ngFor="let role of allroles.filteredOptions"
                [ngClass]="{disabled: userAssignedRole.includes(role.role)}" [value]="role"></sui-select-option>
            </sui-multi-select>
          </div>
          <div class="field">
            <label>{{resourceService.frmelmnts?.lbl?.orgname}}</label>
          </div>
          <div class="field">
            <sui-multi-select [isSearchable]="false" class="selection" [(ngModel)]="orgName"
              (selectedOptionsChange)="enableButton()" formControlName="orgName" [options]="orgList"
              labelField="orgName" valueField="orgId" name="orgName"
              placeholder="{{resourceService?.frmelmnts?.lbl?.dashboardselectorg}}" #allorgName>
              <sui-select-option *ngFor="let org of allorgName.filteredOptions" [value]="org"></sui-select-option>
            </sui-multi-select>
          </div> -->
        </form>
      </div>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
      <button  mat-raised-button class="button-rounded color-accent" role="button" tabindex="0" [disabled]="!enableSubmitBtn" appTelemetryInteract
        [telemetryInteractObject]="telemetryInteractObject" [telemetryInteractEdata]="submitInteractEdata"
        (click)="dismissRoleAssign()" [ngClass]="{'disabled': !enableSubmitBtn}">
        {{resourceService.frmelmnts?.btn?.cancel}}
      </button>
      <button mat-raised-button color="accent" type="button" class="button-rounded ml-8" [disabled]="!enableSubmitBtn" appTelemetryInteract
        [telemetryInteractObject]="telemetryInteractObject" [telemetryInteractEdata]="submitInteractEdata"
        (click)="onSubmitForm()" tabindex="0" [ngClass]="{'disabled': !enableSubmitBtn}">
        {{resourceService.frmelmnts?.btn?.save}}
      </button>
    </mat-dialog-actions>
  </ng-template>
</app-modal-wrapper>

<app-modal-wrapper *ngIf="showDelete" [config]="{disableClose: false, width: '30rem', panelClass: 'material-modal'}" (dismiss)="dismiss()">
  <ng-template sbModalContent>
    <div mat-dialog-title>
      <div class="title" tabindex="0">{{resourceService?.frmelmnts?.lbl?.delete}}</div>
      <span class="example-spacer"></span>
      <button mat-mini-fab color="warn" class="ml-auto" aria-label="close dialog"
        mat-dialog-close><mat-icon>close</mat-icon></button>
    </div>
    <mat-dialog-content>
      {{resourceService?.frmelmnts?.lbl?.deleteConfirm}}
    </mat-dialog-content>
    <mat-dialog-actions align="end">
      <button mat-raised-button class="button-rounded color-warn" role="button" tabindex="0" (click)="dismiss()" tabindex="0" mat-dialog-close
        >{{resourceService?.frmelmnts?.btn?.cancel}}
      </button>
      <button mat-raised-button color="warn" type="button" class="button-rounded ml-8" tabindex="0" (click)="deleteRoleConformed()">
        {{resourceService?.frmelmnts?.btn?.yes}}
    </button>
    </mat-dialog-actions>
  </ng-template>
</app-modal-wrapper>