<mat-accordion [ngClass]="{'sb-single-pannel-accordion-fixed': isOpen === true, 'hide': visibility === false}"
  *ngIf="contentResponse?.length"> 
  <mat-expansion-panel [expanded]="isOpen" (click)="getContentList()">
    <mat-expansion-panel-header>
      <mat-panel-title appTelemetryInteract [telemetryInteractEdata]="getTelemetryInteractData()">
        {{resourceService?.frmelmnts?.lbl?.contentManager}}
      </mat-panel-title>
    </mat-expansion-panel-header>
    <div *ngIf="contentResponse">
      <div class="text-left"
        *ngFor="let data of contentResponse">
        <mat-icon *ngIf="data.status === 'completed'">check_circle</mat-icon>
        <div class="download-details-container" [ngClass]="{'cursor-pointer': data.status === 'completed'}" tabindex="0"
          (click)="openContent(data)">
          <div class="d-flex flex-ai-center flex-w-wrap">
            <div class="download-text mr-auto">{{data.name}}</div>

            <!-- Buttons -->
            <button *ngIf="cancelId !== data.id && (data.status === 'pausing' || data.status === 'inProgress')"
              type="button" mat-raised-button class="color-accent button-rounded ml-8" tabindex="0"
              (click)="contentManagerActions(data.addedUsing, 'Pause', data.id); updateLocalStatus(data, 'pausing');"
              [disabled]="data.status === 'pausing'" appTelemetryInteract
              [telemetryInteractEdata]="getButtonsInteractData('pause', data.downloadedSize)"
              [telemetryInteractCdata]="[{ 'type': data.addedUsing, 'id': data.id }]"
              [telemetryInteractObject]="{id:data.contentId, type: 'Content', ver:data.pkgVersion ? data.pkgVersion : ''}">
              {{resourceService?.frmelmnts?.btn?.pause}}
            </button>

            <button
              *ngIf="cancelId !== data.id && (data.status === 'paused' || data.status === 'resume' || data.status === 'resuming')"
              type="button" mat-raised-button class="color-accent button-rounded ml-8" tabindex="0"
              (click)="contentManagerActions(data.addedUsing, 'Resume', data.id); updateLocalStatus(data, 'resuming');"
              [disabled]="data.status === 'resuming'  || data.status === 'resume'" appTelemetryInteract
              [telemetryInteractEdata]="getButtonsInteractData('resume', data.downloadedSize)"
              [telemetryInteractCdata]="[{ 'type': data.addedUsing, 'id': data.id }]"
              [telemetryInteractObject]="{id:data.contentId, type: 'Content', ver:data.pkgVersion ? data.pkgVersion : ''}">
              {{resourceService?.frmelmnts?.btn?.resume}}
            </button>

            <button
              *ngIf="(data.status === 'inProgress' || data.status === 'inQueue' || data.status === 'paused') && cancelId !== data.id"
              type="button" mat-raised-button color="warn" class="button-rounded ml-8" tabindex="0"
              (click)="cancelId = data.id;" [disabled]="data.status === 'canceling'" appTelemetryInteract
              [telemetryInteractEdata]="getButtonsInteractData('cancel', data.downloadedSize)"
              [telemetryInteractCdata]="[{ 'type': data.addedUsing, 'id': data.id }]"
              [telemetryInteractObject]="{id:data.contentId, type: 'Content', ver:data.pkgVersion ? data.pkgVersion : ''}">
              {{resourceService?.frmelmnts?.btn?.cancel}}
            </button>

            <button *ngIf="data.status === 'failed' || data.status === 'retrying'" type="button"
              mat-raised-button color="warn" class="button-rounded ml-8" tabindex="0"
              (click)="contentManagerActions(data.addedUsing, 'Retry', data.id); updateLocalStatus(data, 'retrying');"
              [disabled]="data.status === 'retrying'" appTelemetryInteract
              [telemetryInteractEdata]="getButtonsInteractData('retry', data.downloadedSize)"
              [telemetryInteractCdata]="[{ 'type': data.addedUsing, 'id': data.id }]"
              [telemetryInteractObject]="{id:data.contentId, type: 'Content', ver:data.pkgVersion ? data.pkgVersion : ''}">
              {{resourceService?.frmelmnts?.btn?.retry}}
            </button>

            <!-- Buttons -->
          </div>

          <!-- File details -->
          <div class="d-inline-block mat-caption mb-8 w-auto" *ngIf="data.totalSize && data.status !== 'inProgress'">{{data.totalSize | filesize}}
          </div>

          <div *ngIf="data.addedUsing === 'download' && data.status === 'inProgress'" class="d-inline-block mat-caption mb-8 w-auto">
            {{resourceService?.frmelmnts?.lbl?.downloading}}&nbsp;{{data.totalSize | filesize}}</div>

          <div *ngIf="data.addedUsing === 'import' && data.status === 'inProgress'" class="d-inline-block mat-caption mb-8 w-auto">
            {{resourceService?.frmelmnts?.lbl?.uploading}}</div>
          <!-- File details -->

          <!-- Progress bar -->
          <mat-progress-bar color="accent" *ngIf="data.status === 'inProgress' && data.addedUsing === 'download'" mode="determinate" [value]="getContentPercentage(data.downloadedSize, data.totalSize)" class="my-0 mr-0"></mat-progress-bar>
          
          <mat-progress-bar color="accent" *ngIf="data.status === 'inProgress' && data.addedUsing === 'import'" mode="determinate" [value]="data.downloadedSize" class="my-0 mr-0"></mat-progress-bar>

          <!-- Progress bar -->

          <!-- Content status -->
          <div *ngIf="data.status === 'paused' && data.addedUsing === 'import'" class="color-accent mat-body-1">
            {{resourceService?.frmelmnts?.lbl?.uploadPaused}} </div>

          <div *ngIf="data.status === 'retrying' && data.addedUsing === 'download'" class="color-accent mat-body-1">
            {{resourceService?.frmelmnts?.btn?.resuming}} </div>

          <div *ngIf="data.status === 'paused' && data.addedUsing === 'download'" class="color-accent mat-body-1">
            {{resourceService?.frmelmnts?.lbl?.downloadPaused}} </div>

          <div *ngIf="(data.status === 'resuming' || data.status === 'resume')" class="color-accent mat-body-1">
            {{resourceService?.frmelmnts?.btn?.resuming}} </div>

          <div *ngIf="data.status === 'pausing'" class="color-accent mat-body-1">
            {{resourceService?.frmelmnts?.btn?.pausing}} </div>

          <div *ngIf="data.status === 'canceling'" class="color-accent mat-body-1">
            {{resourceService?.frmelmnts?.btn?.canceling}} </div>
          <div *ngIf="data.status === 'completed'" class="mat-caption color-success">
            {{resourceService?.frmelmnts?.btn?.completed}} </div>
          <div *ngIf="data.status === 'extract'" class="mat-caption color-success">
            {{resourceService?.frmelmnts?.desktop?.lbl?.completing}} </div>
          <div *ngIf="data.addedUsing === 'download' && data.status === 'failed'" class="mat-caption color-error">
            {{resourceService?.frmelmnts?.lbl?.downloadFailed}} </div>

          <div *ngIf="data.addedUsing === 'import' && data.status === 'failed'" class="mat-caption color-error">
            {{resourceService?.frmelmnts?.lbl?.uploadFailed}} </div>

          <div *ngIf="data.addedUsing === 'import' && data.status === 'inQueue'" class="mat-caption color-warn">
            {{resourceService?.frmelmnts?.lbl?.waitingForUpload}} </div>

          <div *ngIf="data.addedUsing === 'download' && data.status === 'inQueue'" class="mat-caption color-warn">
            {{resourceService?.frmelmnts?.lbl?.waitingForDownload}} </div>
          <!-- Content status -->

          <!-- Cancel confirmation message -->
          <div class="d-flex flex-ai-center mt-8 ml-0"
            *ngIf="cancelId === data.id && (data.status !== 'completed' && data.status !== 'failed')">
            <div *ngIf="data.addedUsing === 'import'" class="mat-subheading-1 font-weight-bold color-error mr-auto">
              {{resourceService?.frmelmnts?.lbl?.cancelUpload}}
            </div>
            <div *ngIf="data.addedUsing === 'download'" class="mat-subheading-1 font-weight-bold color-error mr-auto">
              {{resourceService?.frmelmnts?.lbl?.cancelDownload}}
            </div>
            <button tabindex="0"
              (click)="contentManagerActions(data.addedUsing, 'Cancel', data.id); updateLocalStatus(data, 'canceling'); cancelId = '';"
              class="button-rounded color-accent ml-8" mat-raised-button type="button" appTelemetryInteract
              [telemetryInteractEdata]="getButtonsInteractData('confirm-cancel', getContentPercentage(data.downloadedSize, data.totalSize))"
              [telemetryInteractCdata]="[{ 'type': data.addedUsing, 'id': data.id }]"
              [telemetryInteractObject]="{id:data.contentId, type: 'Content', ver:data.pkgVersion ? data.pkgVersion : ''}">
              {{resourceService?.frmelmnts?.btn?.yes}} </button>
            <button tabindex="0" (click)="cancelId = '';" mat-raised-button color="error" class="button-rounded ml-8"
              type="button" appTelemetryInteract
              [telemetryInteractEdata]="getButtonsInteractData('deny-cancel', getContentPercentage(data.downloadedSize, data.totalSize))"
              [telemetryInteractCdata]="[{ 'type': data.addedUsing, 'id': data.id }]"
              [telemetryInteractObject]="{id:data.contentId, type: 'Content', ver:data.pkgVersion ? data.pkgVersion : ''}">
              {{resourceService?.frmelmnts?.btn?.no}} </button>
          </div>
          <!-- Cancel confirmation message -->
        </div>
      </div>
    </div>
  </mat-expansion-panel>
</mat-accordion>



<app-content-manager-info-pop-up *ngIf="unHandledFailedList?.length" [showContentChangeWarning]="isWindows"
  [failedList]="unHandledFailedList" [drives]="drives" (dismissed)="closeModal($event)">
</app-content-manager-info-pop-up>