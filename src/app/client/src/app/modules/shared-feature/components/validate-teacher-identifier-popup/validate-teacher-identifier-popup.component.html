<app-modal-wrapper [config]="{disableClose: true, size: 'normal', width: '45rem'}"
  [appTelemetryImpression]="telemetryImpressionData" #createValidateModal>
  <ng-template sbModalContent>

    <!--Header-->
    <div mat-dialog-title class="mb-0">
      <h2 class="mb-0">{{labels?.popupHeaderLabel}}</h2>
      <button mat-mini-fab color="warn" class="ml-auto" aria-label="close dialog"
        mat-dialog-close><mat-icon>close</mat-icon></button>
    </div>
    <!--/Header-->

    <!--modal content-->
    <mat-dialog-content>
      <div *ngIf="!processValidation">
        {{labels?.headerLabel}}
      </div>
      <form [formGroup]="userDetailsForm">
        <div *ngIf="processValidation && !(extIdVerified || extIdFailed)" class="mb-16 text-left">
          <mat-form-field *ngIf="showStateDropdown" class="sb-mat__dropdown mb-16 w100" appearance="fill">
            <mat-label>{{resourceService?.frmelmnts?.lbl?.state}}</mat-label>
            <mat-select id="stateField" [isSearchable]="false" [options]="options" formControlName="state" tabindex="0">
              <mat-option class="mat-dropdown__options" role="option" *ngFor="let option of channelData" [value]="option"></mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="w-100" appearance="fill">
            <mat-label>{{labels?.fieldLabel}}</mat-label>
            <input matInput #extIdInputField type="text" required name="extId" placeholder="For example, ER12345" [formControl]="extId">
            <mat-error *ngIf="showError">{{labels?.incorrectIDLabel}}</mat-error>
          </mat-form-field>
        </div>
      </form>
      <!-- Success / error field  -->
      <div *ngIf="extIdVerified" class="text-center my-24">
        {{labels?.verificationSuccessfulLabel}}
      </div>

      <div *ngIf="extIdFailed" class="text-center my-24">
        {{labels?.verficationFailureLabel}}
      </div>
    </mat-dialog-content>
    <!--modal content-->

    <!--action buttons-->

    <mat-dialog-actions align="end">
      <div class="action-btns" *ngIf="!processValidation">
        <button tabindex="0" appTelemetryInteract
          [telemetryInteractEdata]="{id:'ext-user-verify-reject' , type:'click' , pageid: pageId }"
          [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject" type="button"
          mat-raised-button class="button-rounded mr-8" (click)="verifyExtId('reject'); closeModal()">
          {{resourceService?.frmelmnts?.btn?.no}}
        </button>
        <button tabindex="0" appTelemetryInteract
          [telemetryInteractEdata]="{id:'ext-user-verify-confirm' , type:'click' , pageid: pageId }"
          [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject" type="button"
          mat-raised-button color="accent" class="button-rounded" (click)="navigateToValidateId()">
          {{resourceService?.frmelmnts?.btn?.yes}}
        </button>
      </div>
      <button tabindex="0" appTelemetryInteract [telemetryInteractEdata]="closeInteractEdata"
        [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject"
        *ngIf="extIdVerified || extIdFailed"
        [ngClass]="{'sb-btn-error' : extIdFailed, 'sb-btn-success' : extIdVerified }" type="button" mat-raised-button
        class="button-rounded mr-8" (click)="closeModal()">
        <!--sb-btn-success-->
        {{resourceService?.frmelmnts?.btn?.ok}}
      </button>
      <button tabindex="0" appTelemetryInteract
        [telemetryInteractEdata]="{id:'ext-user-verify-submit' , type:'click' , pageid: pageId }"
        [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject"
        [disabled]="!enableSubmitButton" *ngIf="processValidation && !(extIdVerified || extIdFailed)" type="submit"
        mat-raised-button color="accent" class="button-rounded" (click)="verifyExtId('accept')">
        {{resourceService?.frmelmnts?.btn?.submit}}
      </button>
    </mat-dialog-actions>
    <!--action buttons-->

  </ng-template>
</app-modal-wrapper>