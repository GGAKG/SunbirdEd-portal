<app-modal-wrapper [config]="{disableClose: true, size: 'normal', width: '45rem'}"
  [appTelemetryImpression]="telemetryImpressionData" #createValidateModal>
  <ng-template sbModalContent>

    <!--Header-->
    <div mat-dialog-title class="mb-0">
      <h2 class="mb-0">{{labels?.popupHeaderLabel}}</h2>
      <button mat-mini-fab color="warn" class="ml-auto" aria-label="close dialog"
        mat-dialog-close><mat-icon>close</mat-icon></button>
    </div>
    <!--/Header-->

    <!--modal content-->
    <mat-dialog-content>
      <div *ngIf="!processValidation">
        {{labels?.headerLabel}}
      </div>
      <form class="sb-form" [formGroup]="userDetailsForm">
        <div *ngIf="processValidation && !(extIdVerified || extIdFailed)" class="sb-field-group mb-16 text-left">
          <div class="sb-field" *ngIf="showStateDropdown">
            <label>{{resourceService?.frmelmnts?.lbl?.state}}</label>
            <sui-select id="stateField" [isSearchable]="false" class="selection" [options]="options"
              formControlName="state">
              <sui-select-option *ngFor="let option of channelData" [value]="option"></sui-select-option>
            </sui-select>
          </div>
          <div class="sb-field">
            <label class="required">{{labels?.fieldLabel}}</label>
            <input #extIdInputField type="text" required name="extId" placeholder="For example, ER12345"
              class="sb-form-control" formControlName="extId" />
            <span *ngIf="showError" class="sb-color-error fxsmall mt-8">
              {{labels?.incorrectIDLabel}}
            </span>
          </div>
        </div>
      </form>
      <!-- Success / error field  -->
      <div *ngIf="extIdVerified" class="text-center my-24">
        {{labels?.verificationSuccessfulLabel}}
      </div>

      <div *ngIf="extIdFailed" class="text-center my-24">
        {{labels?.verficationFailureLabel}}
      </div>
    </mat-dialog-content>
    <!--modal content-->

    <!--action buttons-->

    <mat-dialog-actions align="end">
      <div class="action-btns" *ngIf="!processValidation">
        <button tabindex="0" appTelemetryInteract
          [telemetryInteractEdata]="{id:'ext-user-verify-reject' , type:'click' , pageid: pageId }"
          [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject" type="button"
          mat-raised-button class="button-rounded mr-8" (click)="verifyExtId('reject'); closeModal()">
          {{resourceService?.frmelmnts?.btn?.no}}
        </button>
        <button tabindex="0" appTelemetryInteract
          [telemetryInteractEdata]="{id:'ext-user-verify-confirm' , type:'click' , pageid: pageId }"
          [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject" type="button"
          mat-raised-button color="accent" class="button-rounded" (click)="navigateToValidateId()">
          {{resourceService?.frmelmnts?.btn?.yes}}
        </button>
      </div>
      <button tabindex="0" appTelemetryInteract [telemetryInteractEdata]="closeInteractEdata"
        [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject"
        *ngIf="extIdVerified || extIdFailed"
        [ngClass]="{'sb-btn-error' : extIdFailed, 'sb-btn-success' : extIdVerified }" type="button" mat-raised-button
        class="button-rounded mr-8" (click)="closeModal()">
        <!--sb-btn-success-->
        {{resourceService?.frmelmnts?.btn?.ok}}
      </button>
      <button tabindex="0" appTelemetryInteract
        [telemetryInteractEdata]="{id:'ext-user-verify-submit' , type:'click' , pageid: pageId }"
        [telemetryInteractCdata]="telemetryCdata" [telemetryInteractObject]="telemetryInteractObject"
        [disabled]="!enableSubmitButton" *ngIf="processValidation && !(extIdVerified || extIdFailed)" type="submit"
        mat-raised-button color="accent" class="button-rounded" (click)="verifyExtId('accept')">
        {{resourceService?.frmelmnts?.btn?.submit}}
      </button>
    </mat-dialog-actions>
    <!--action buttons-->

  </ng-template>
</app-modal-wrapper>