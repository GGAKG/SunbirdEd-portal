<mat-accordion class="global-consent-pii-component" *ngIf="showSettingsPage" >
  <mat-expansion-panel class="mat-app-background">
    <mat-expansion-panel-header>
      <mat-panel-title class="">
        {{resourceService?.frmelmnts?.lbl?.dataSetting}}
      </mat-panel-title>
    </mat-expansion-panel-header>
    <div class="" role="region" id="dataSetting"
      aria-labelledby="dataSetting">
      <label class="mat-body-1 text-uppercase">{{resourceService?.frmelmnts?.lbl?.dataSharingIs}}
        <span>{{ isDataShareOn ? resourceService?.frmelmnts?.lbl?.on : resourceService?.frmelmnts?.lbl?.off }}</span>
      </label>

      <p class="mat-small mb-0" *ngIf="isDataShareOn">{{resourceService?.frmelmnts?.lbl?.dataShareOnNote}}</p>
      <p class="mat-small mb-0" *ngIf="!isDataShareOn">{{resourceService?.frmelmnts?.lbl?.dataShareOffNote}}</p>
      <label class="mat-small"
        *ngIf="lastUpdatedOn">{{resourceService?.frmelmnts?.lbl?.lastUpdatedOn}} {{lastUpdatedOn | date
        :'dd/MM/yyyy'}}</label>

      <div class="d-flex flex-ai-end flex-jc-flex-end">
        <button class="button-rounded" mat-raised-button color="accent"
          (click)="toggleEditSetting()" tabindex="0">
          {{ editSetting ? resourceService?.frmelmnts?.btn?.close : resourceService?.frmelmnts?.lbl?.editSetting }}
        </button>
      </div>

      <div *ngIf="editSetting" class="sb-update-data-settings">
        <mat-divider class="my-16"></mat-divider>
        <!-- Material Radio button -->
        <label class="mat-small mb-0 font-weight-bold">{{resourceService?.frmelmnts?.lbl?.updateSetting}}</label>
        <div class="d-flex py-8 flex-w-wrap globalConsent-mat-radion-btns">
          <mat-radio-group [(ngModel)]="consentPii">
            <mat-radio-button value="Yes" id="shareConsent">
              {{resourceService?.frmelmnts?.lbl?.shareProfileDetails}}
            </mat-radio-button>
            <mat-radio-button value="No" id="noShareContent">{{resourceService?.frmelmnts?.lbl?.notShareProfileDetails}}</mat-radio-button>
          </mat-radio-group>
        </div>
        <button class="color-accent button-rounded w-100" mat-raised-button tabindex="0"
          (click)="saveConsent()">{{resourceService?.frmelmnts?.btn?.save}}</button>
      </div>
    </div>
  </mat-expansion-panel>
</mat-accordion>

<app-modal-wrapper *ngIf="showConsentPopup" [config]="{disableClose: true, width: '45rem', panelClass: ['overflow-visible', 'material-modal']}"
  (dismiss)="showConsentPopup = false;" #profileDetailsModal>
  <ng-template sbModalContent>

    <div mat-dialog-title>
      <h2>{{resourceService?.frmelmnts?.lbl?.consentsharedetail}}</h2>
      <span class="example-spacer"></span>
      <button mat-mini-fab color="warn" mat-dialog-close aria-label="close dialog">
        <mat-icon>close</mat-icon>
      </button>
    </div>
  
    <mat-dialog-content class="pb-0">
      <div class="profile-fields mat-body-1">
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.dashboardsortbyusername}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.name || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.state}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.state || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.userId}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.userid || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.externalId}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.externalId || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.district}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.district || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.block}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.block || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.schoolId}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.schoolId || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.schoolName}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.schoolName || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.mobileNumber}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.phone || '-'}}</div>
        </div>
        <div class="d-flex mb-16">
          <div class="font-weight-bold profile-field-label">{{resourceService?.frmelmnts?.lbl?.emailId}}</div>
          <span class="mx-8">:</span>
          <div>{{userInformation.emailId || '-'}}</div>
        </div>
      </div>
      <div class="mb-16 mat-body-1 d-flex flex-ai-center" *ngIf="type === 'course-consent'">
        <mat-icon>info</mat-icon>
        <span class="ml-8">{{resourceService?.frmelmnts?.lbl?.canEditProfileDetails}}</span>
      </div>
      <p class="mb-0 mat-body-1 globalConsent-mat-checkbox">
        <mat-checkbox [(ngModel)]="isTncAgreed" aria-label="term and condition checkbox">{{consentConfig.tncText | interpolate:'{instance}': instance}}
          <a class="color-accent" href="javascript:void(0)" tabindex="0" (click)="showTncPopup=true">
            {{consentConfig.tncLink | interpolate:'{instance}': resourceService?.instance}}
          </a>
        </mat-checkbox>
       
      </p>
    </mat-dialog-content>
  
    <mat-dialog-actions align="end">
      <button mat-raised-button class="button-rounded text-uppercase color-accent" tabindex="0"
      (click)="updateUserConsent(false)"
      *ngIf="type === 'course-consent'">{{resourceService?.frmelmnts?.lbl?.dontShare}}</button>
    <button type="button" mat-raised-button color="accent" tabindex="0" [disabled]="!isTncAgreed"
      class="button-rounded text-uppercase ml-8" (click)="updateUserConsent(true)"
      *ngIf="type === 'global-consent'">{{resourceService?.frmelmnts?.lbl?.continue}}</button>
    <button type="button" mat-raised-button color="accent" tabindex="0" [disabled]="!isTncAgreed"
    class="button-rounded text-uppercase ml-8" (click)="updateUserConsent(true)"
    *ngIf="type === 'course-consent'">{{resourceService?.frmelmnts?.lbl?.share}}</button>
    </mat-dialog-actions>
  </ng-template>
</app-modal-wrapper>

<app-tnc-popup (close)="showAndHidePopup(false)" [tncUrl]="termsAndConditionLink" *ngIf="showTncPopup">
</app-tnc-popup>