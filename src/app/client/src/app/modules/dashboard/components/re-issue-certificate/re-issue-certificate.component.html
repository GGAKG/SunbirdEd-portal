<div class="sb-g re-issue-cert p-16" [appTelemetryImpression]="telemetryImpression">
  <div class="sb-g-col-xs-12 sb-g-col-md-7 sb-g-col-lg-7 sb-g-col-xxxl-9">
    <div class="mat-title color-accent font-weight-bold mb-24">{{resourceService?.frmelmnts?.lbl?.cert}} </div>
    <div class="certificate-id-content">
      <label class="w-100 mb-16" for="id">
        <span>{{resourceService?.frmelmnts?.lbl?.enterInstanceId | interpolate:'{instance}': channelName}}
          {{resourceService?.frmelmnts?.lbl?.or}} {{resourceService?.frmelmnts?.lbl?.enterUUID}}
        </span></label>
      <div class="d-flex flex-ai-flex-start">
        <!-- <div class="user-id-input">
          <label for="search-user-input-id" class="hide">{{resourceService?.frmelmnts?.lbl?.searchUser}}</label>
          <input class="sb-form-control font-weight-bold" id="search-user-input-id" name="id"
            placeholder="{{resourceService?.frmelmnts?.lbl?.searchUser}}" type="id" [(ngModel)]="userName"
            (ngModelChange)="resetValues()">
          <small class="message sb-color-error font-weight-bold mt-8"></small>
        </div> -->
        <mat-form-field class="w-100" appearance="fill" color="accent">
          <mat-label>{{resourceService?.frmelmnts?.lbl?.searchUser}}</mat-label>
          <input matInput id="search-user-input-id" name="id" placeholder="{{resourceService?.frmelmnts?.lbl?.searchUser}}" type="id" (ngModelChange)="resetValues()" [(ngModel)]="userName">
        </mat-form-field>
        <button mat-raised-button color="accent" class="button-rounded ml-16 mt-8" id="search-btn" type="button" tabindex="0" (click)="searchCertificates();addTelemetry('search-user-cert', {userId: userName, courseId: courseId})" [disabled]="!userName?.trim()" #searchBtn>{{resourceService?.frmelmnts?.lbl?.search}}</button>
      </div>
    </div>
  </div>
  <div class="sb-g-col-xs-12 sb-g-col-md-5 sb-g-col-lg-5 sb-g-col-xxxl-7">
    <div class="mat-caption certificate-id-info">
      <div> {{resourceService?.frmelmnts?.lbl?.whatInstanceId | interpolate:'{instance}': channelName}} </div>
      <div class="py-8">{{resourceService?.frmelmnts?.reissue?.lbl?.instructions | interpolate:'{instance}':
        channelName}}</div>
      <div class="pt-8">
        <div>{{resourceService?.frmelmnts?.lbl?.step1}} {{resourceService?.frmelmnts?.lbl?.profileTab}}</div>
        <div class="py-8">{{resourceService?.frmelmnts?.lbl?.step2}}
          {{resourceService?.frmelmnts?.reissue?.lbl?.displayUser | interpolate:'{instance}': channelName}}</div>
      </div>
    </div>
  </div>
</div>

<div class="mt-24" *ngIf="userData?.courses?.batches.length">
  <div class="px-16 py-24">
    <div class="d-flex re-issue-list-content">
      <div class="px-16">
        <div class="sb-g mt-0 re-issue-list-content__labels">
          <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
            <div class="re-issue-label">{{toLowerCase(resourceService?.frmelmnts?.lbl?.batch_name)}}</div>
          </div>
          <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
            <div class="re-issue-label">{{toLowerCase(resourceService?.frmelmnts?.lbl?.dashboardsortbyusername)}}
            </div>
          </div>
          <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
            <div class="re-issue-label">{{toLowerCase(resourceService?.frmelmnts?.lbl?.userDistrict)}}</div>
          </div>
          <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
            <div class="re-issue-label text-center">{{toLowerCase(resourceService?.frmelmnts?.lbl?.courseProgress)}}
            </div>
          </div>
          <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2 pl-0">
            <div class="re-issue-label text-center">
              {{toLowerCase(resourceService?.frmelmnts?.lbl?.reissue?.criteriaMet)}}</div>

            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
              <div class="re-issue-label text-center"></div>
            </div>
          </div>
        </div>
        <div class="re-issue-list-content__data">
          <div class="sb-g mt-0" *ngFor="let batch of userData?.courses?.batches">
            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
              <div class="re-issue-status" suiPopup popupHeader="{{batch?.name}}" *ngIf="batch?.name?.length >= 50">
                {{batch?.name}} </div>
              <div class="re-issue-status" *ngIf="batch?.name?.length < 50">{{batch?.name}} </div>
            </div>
            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
              <div class="re-issue-status" suiPopup popupHeader="{{userData?.userName}}"
                *ngIf="userData?.userName?.length >= 50">{{userData?.userName}}</div>
              <div class="re-issue-status" *ngIf="userData?.userName?.length < 50">{{userData?.userName}}</div>
            </div>
            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2">
              <div class="re-issue-status" suiPopup popupHeader="{{userData?.district}}"
                *ngIf="userData?.district?.length >= 48">{{userData?.district}}"></div>
              <div class="re-issue-status" *ngIf="userData?.district?.length < 48">{{userData?.district}}</div>
            </div>
            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2 text-center">
              <div class="re-issue-status">{{batch?.completionPercentage || 0}}%</div>
            </div>
            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2 text-center">
              <div class="re-issue-status">{{ criteriaMet ? resourceService?.frmelmnts?.btn?.yes :
                resourceService?.frmelmnts?.btn?.no }}</div>
            </div>
            <div class="sb-g-col-xs-2 sb-g-col-md-2 sb-g-col-lg-2 sb-g-col-xxxl-2 pl-0" *ngIf="batch?.certificates?.length || batch?.status === 2">
              <div class="re-issue-status text-center cursor-pointer">
                <a class="font-weight-bold color-accent" tabindex="0"
                  (click)="toggleModal(true, batch);addTelemetry('re-issue-cert', { userId: userData?.userId, courseId: userData?.courses?.courseId, batchId: userBatch?.batchId })">{{resourceService?.frmelmnts?.lbl?.re_issue}}</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex flex-dc w-100" *ngIf="userData?.courses?.batches?.length">
    <div class="records-count-label pt-16 pl-16">{{resourceService?.frmelmnts?.lbl?.showingrecord | interpolate:
      '{count}': userData?.courses?.batches.length}} {{resourceService?.frmelmnts?.lbl?.totalrecords | interpolate:
      '{total}': userData?.courses?.batches.length}}</div>
  </div>
</div>

<app-modal-wrapper *ngIf="showModal"
  [config]="{disableClose: true, size: 'small', width: '30rem', panelClass: 'material-modal'}"
  (dismiss)="toggleModal(false);addTelemetry('close-re-issue-popup', { userId: userData?.userId, courseId: userData?.courses?.courseId, batchId: userBatch?.batchId })"
  #modal>
  <ng-template sbModalContent>

    <div mat-dialog-title class="mb-0">
      <h2 class="color-accent font-weight-bold mb-0">{{resourceService?.frmelmnts?.lbl?.cert}} ?</h2>
    </div>
    <mat-dialog-content>
      <p> {{resourceService?.messages?.dashboard?.imsg?.m001 | interpolate:'{userName}': userData?.userName}}</p>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
      <button mat-raised-button class="button-rounded mr-8" tabindex="0"
        (click)="toggleModal(false);addTelemetry('re-issue-cert-cancel', { userId: userData?.userId, courseId: userData?.courses?.courseId, batchId: userBatch?.batchId })">{{resourceService?.frmelmnts?.btn?.no}}</button>
      <button mat-raised-button color="accent" class="button-rounded" tabindex="0"
        (click)="reIssueCert(userBatch);addTelemetry('re-issue-cert-confirm', { userId: userData?.userId, courseId: userData?.courses?.courseId, batchId: userBatch?.batchId })">{{resourceService?.frmelmnts?.btn?.yes}}</button>
    </mat-dialog-actions>

  </ng-template>
</app-modal-wrapper>